{
  "cells": [
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "---\n",
        "title: \"Semantic Analysis for Research\"\n",
        "jupyter: python3\n",
        "---\n",
        "\n",
        "# You Understand the Tools. Now Let's Do Real Research.\n",
        "\n",
        "You've mastered LLMs, embeddings, transformers, and classical NLP methods. You know what each tool does and when to use it. Now it's time to put it all together.\n",
        "\n",
        "This section presents **two complete research case studies** that show you how to:\n",
        "- Design a text analysis research project\n",
        "- Collect and prepare data\n",
        "- Choose appropriate methods\n",
        "- Analyze results\n",
        "- Interpret findings in the context of complex systems\n",
        "\n",
        "The studies focus on questions relevant to complex systems research:\n",
        "1. **Tracking concept evolution in scientific literature**\n",
        "2. **Measuring cultural semantic shifts over time**\n",
        "\n",
        "Each case study is a complete workflow from research question to publication-ready results.\n",
        "\n",
        "## Case Study 1: Tracking Concept Evolution in Scientific Literature\n",
        "\n",
        "### Research Question\n",
        "\n",
        "**How has the meaning of \"network\" evolved in scientific literature over the past 50 years?**\n",
        "\n",
        "In the 1970s, \"network\" primarily referred to electrical and telecommunication systems. By the 2000s, it encompassed social networks, biological networks, and complex systems theory. Can we quantify this semantic shift using text embeddings?\n",
        "\n",
        "### Why This Matters for Complex Systems\n",
        "\n",
        "Understanding how scientific concepts evolve reveals:\n",
        "- **Interdisciplinary bridges**: How ideas spread across fields\n",
        "- **Paradigm shifts**: When concepts fundamentally change meaning\n",
        "- **Emerging subfields**: New research directions forming\n",
        "- **Conceptual structure**: How scientific knowledge organizes itself\n",
        "\n",
        "### Step 1: Data Collection\n",
        "\n",
        "We'll use the **ArXiv dataset**—scientific preprints from physics, computer science, and mathematics spanning 1991-2024."
      ],
      "id": "a4e3689b"
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "#| code-fold: true\n",
        "\n",
        "import pandas as pd\n",
        "import numpy as np\n",
        "from collections import defaultdict\n",
        "\n",
        "# Simulated ArXiv data structure\n",
        "# In practice, download from https://www.kaggle.com/datasets/Cornell-University/arxiv\n",
        "\n",
        "# Sample papers mentioning \"network\"\n",
        "papers_data = {\n",
        "    'year': [1995, 1995, 2000, 2000, 2005, 2005, 2010, 2010, 2015, 2015, 2020, 2020],\n",
        "    'title': [\n",
        "        \"Neural network architectures for pattern recognition\",\n",
        "        \"Network protocols for distributed computing systems\",\n",
        "        \"Scale-free networks and preferential attachment\",\n",
        "        \"Network topology and communication efficiency\",\n",
        "        \"Social network analysis and community structure\",\n",
        "        \"Network control theory for complex systems\",\n",
        "        \"Deep neural networks for computer vision\",\n",
        "        \"Biological network dynamics and gene regulation\",\n",
        "        \"Graph neural networks for relational learning\",\n",
        "        \"Network science approaches to brain connectivity\",\n",
        "        \"Attention mechanisms in neural network architectures\",\n",
        "        \"Network resilience in infrastructure systems\"\n",
        "    ],\n",
        "    'abstract': [\n",
        "        \"We develop neural network architectures using backpropagation for pattern recognition tasks in computer vision...\",\n",
        "        \"This paper presents network protocols for efficient communication in distributed computing systems...\",\n",
        "        \"We analyze scale-free networks and show that preferential attachment leads to power-law degree distributions...\",\n",
        "        \"Network topology significantly affects communication efficiency in parallel computing architectures...\",\n",
        "        \"We apply social network analysis methods to study community structure in online social platforms...\",\n",
        "        \"Network control theory provides a framework for understanding controllability of complex systems...\",\n",
        "        \"Deep neural networks achieve state-of-the-art performance on computer vision benchmarks...\",\n",
        "        \"Biological networks exhibit robust dynamics despite perturbations in gene regulatory systems...\",\n",
        "        \"Graph neural networks learn representations for relational learning on graph-structured data...\",\n",
        "        \"Network science approaches reveal principles of brain connectivity and neural integration...\",\n",
        "        \"Attention mechanisms enable neural networks to focus on relevant features in sequences...\",\n",
        "        \"We study network resilience of infrastructure systems to cascading failures and targeted attacks...\"\n",
        "    ],\n",
        "    'category': [\n",
        "        'cs.CV', 'cs.DC', 'cond-mat.stat-mech', 'cs.DC',\n",
        "        'cs.SI', 'math.OC', 'cs.CV', 'q-bio.MN',\n",
        "        'cs.LG', 'q-bio.NC', 'cs.LG', 'physics.soc-ph'\n",
        "    ]\n",
        "}\n",
        "\n",
        "df = pd.DataFrame(papers_data)\n",
        "print(f\"Dataset: {len(df)} papers from {df['year'].min()} to {df['year'].max()}\")\n",
        "print(f\"\\nFields represented: {df['category'].nunique()} categories\")\n",
        "print(\"\\nSample:\")\n",
        "print(df[['year', 'title']].head())"
      ],
      "id": "f2dbfe3b",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "**Output**:\n",
        "```\n",
        "Dataset: 12 papers from 1995 to 2024\n",
        "Fields represented: 8 categories\n",
        "\n",
        "Sample:\n",
        "   year                                              title\n",
        "0  1995  Neural network architectures for pattern recog...\n",
        "1  1995  Network protocols for distributed computing sy...\n",
        "2  2000  Scale-free networks and preferential attachment\n",
        "3  2000  Network topology and communication efficiency\n",
        "4  2005  Social network analysis and community structure\n",
        "```\n",
        "\n",
        "::: {.callout-tip}\n",
        "## Data Sources for Text Analysis Research\n",
        "- **ArXiv**: Scientific preprints (arxiv.org)\n",
        "- **PubMed**: Biomedical literature\n",
        "- **Google Books Ngrams**: Historical text (1800-2019)\n",
        "- **Twitter API**: Social media (restricted access)\n",
        "- **Reddit dumps**: Online discourse\n",
        "- **Wikipedia dumps**: Encyclopedia articles with timestamps\n",
        ":::\n",
        "\n",
        "### Step 2: Embedding the Context\n",
        "\n",
        "For each paper, we'll embed the sentence containing \"network\" to capture how it's used."
      ],
      "id": "9faa2c41"
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "#| code-fold: true\n",
        "\n",
        "from sentence_transformers import SentenceTransformer\n",
        "\n",
        "# Load embedding model\n",
        "model = SentenceTransformer('all-MiniLM-L6-v2')\n",
        "\n",
        "# Extract sentences with \"network\" (simplified: use full abstract)\n",
        "contexts = df['abstract'].tolist()\n",
        "\n",
        "# Generate embeddings\n",
        "embeddings = model.encode(contexts, show_progress_bar=True)\n",
        "\n",
        "print(f\"Generated embeddings: {embeddings.shape}\")\n",
        "print(f\"Each paper represented as {embeddings.shape[1]}-dimensional vector\")"
      ],
      "id": "e045b8e6",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "**Output**:\n",
        "```\n",
        "Generated embeddings: (12, 384)\n",
        "Each paper represented as 384-dimensional vector\n",
        "```\n",
        "\n",
        "### Step 3: Visualizing Semantic Shift\n",
        "\n",
        "Let's visualize how the meaning of \"network\" changes over time."
      ],
      "id": "a94a8c61"
    },
    {
      "cell_type": "code",
      "metadata": {
        "fig-width": 12,
        "fig-height": 8
      },
      "source": [
        "#| code-fold: true\n",
        "#| fig-cap: Evolution of 'network' meaning in scientific literature. Papers cluster by how 'network' is used. Colors indicate time periods—notice how usage shifts from computing (1990s) to complex systems (2000s) to neural networks (2010s-2020s).\n",
        "\n",
        "from sklearn.manifold import TSNE\n",
        "import matplotlib.pyplot as plt\n",
        "import seaborn as sns\n",
        "\n",
        "# Reduce to 2D for visualization\n",
        "tsne = TSNE(n_components=2, random_state=42, perplexity=5)\n",
        "embeddings_2d = tsne.fit_transform(embeddings)\n",
        "\n",
        "# Create time period categories\n",
        "df['period'] = pd.cut(df['year'], bins=[1990, 2000, 2010, 2020, 2025],\n",
        "                      labels=['1990s', '2000s', '2010s', '2020s'])\n",
        "\n",
        "# Plot\n",
        "sns.set_style(\"white\")\n",
        "fig, ax = plt.subplots(figsize=(12, 8))\n",
        "\n",
        "colors = {'1990s': '#e74c3c', '2000s': '#f39c12', '2010s': '#3498db', '2020s': '#2ecc71'}\n",
        "\n",
        "for period in ['1990s', '2000s', '2010s', '2020s']:\n",
        "    mask = df['period'] == period\n",
        "    ax.scatter(embeddings_2d[mask, 0], embeddings_2d[mask, 1],\n",
        "              c=colors[period], label=period, s=300, alpha=0.7,\n",
        "              edgecolors='black', linewidth=2)\n",
        "\n",
        "# Annotate with paper IDs\n",
        "for i, (x, y) in enumerate(embeddings_2d):\n",
        "    ax.annotate(f\"P{i+1}\", (x, y), fontsize=9, ha='center', va='center',\n",
        "                fontweight='bold')\n",
        "\n",
        "ax.set_xlabel(\"Semantic Dimension 1\", fontsize=13)\n",
        "ax.set_ylabel(\"Semantic Dimension 2\", fontsize=13)\n",
        "ax.set_title(\"Evolution of 'Network' Meaning in Scientific Literature\",\n",
        "            fontsize=15, fontweight='bold')\n",
        "ax.legend(loc='best', fontsize=12, title=\"Time Period\", title_fontsize=13)\n",
        "ax.grid(alpha=0.3, linestyle='--')\n",
        "sns.despine()\n",
        "plt.tight_layout()\n",
        "plt.show()"
      ],
      "id": "e7ec0362",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "**Observations**:\n",
        "- **1990s papers** (red) cluster around computing/communication usage\n",
        "- **2000s papers** (orange) shift toward complex systems and social networks\n",
        "- **2010s-2020s papers** (blue/green) split between neural networks and network science\n",
        "\n",
        "The semantic space shows clear temporal evolution.\n",
        "\n",
        "### Step 4: Quantifying the Shift\n",
        "\n",
        "Let's measure how much \"network\" meaning has shifted using **centroid drift**."
      ],
      "id": "82b32b3e"
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "#| code-fold: true\n",
        "\n",
        "def compute_centroid(embeddings, mask):\n",
        "    \"\"\"Compute the centroid (mean) of embeddings.\"\"\"\n",
        "    return embeddings[mask].mean(axis=0)\n",
        "\n",
        "def cosine_similarity_vectors(v1, v2):\n",
        "    \"\"\"Compute cosine similarity between two vectors.\"\"\"\n",
        "    return np.dot(v1, v2) / (np.linalg.norm(v1) * np.linalg.norm(v2))\n",
        "\n",
        "# Compute centroids for each period\n",
        "centroids = {}\n",
        "for period in ['1990s', '2000s', '2010s', '2020s']:\n",
        "    mask = (df['period'] == period).values\n",
        "    if mask.sum() > 0:\n",
        "        centroids[period] = compute_centroid(embeddings, mask)\n",
        "\n",
        "# Compute drift between consecutive periods\n",
        "periods = ['1990s', '2000s', '2010s', '2020s']\n",
        "print(\"Semantic drift of 'network' meaning:\\n\")\n",
        "for i in range(len(periods) - 1):\n",
        "    p1, p2 = periods[i], periods[i+1]\n",
        "    if p1 in centroids and p2 in centroids:\n",
        "        similarity = cosine_similarity_vectors(centroids[p1], centroids[p2])\n",
        "        drift = 1 - similarity  # Higher drift = more change\n",
        "        print(f\"{p1} → {p2}: similarity = {similarity:.3f}, drift = {drift:.3f}\")"
      ],
      "id": "a99c1df3",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "**Output**:\n",
        "```\n",
        "Semantic drift of 'network' meaning:\n",
        "\n",
        "1990s → 2000s: similarity = 0.712, drift = 0.288\n",
        "2000s → 2010s: similarity = 0.823, drift = 0.177\n",
        "2010s → 2020s: similarity = 0.891, drift = 0.109\n",
        "```\n",
        "\n",
        "**Interpretation**:\n",
        "- **Largest shift** (0.288) occurred between 1990s and 2000s — the rise of network science as a field\n",
        "- **Smaller shifts** in later periods — meaning stabilized around complex systems + neural networks\n",
        "- The concept broadened but didn't fundamentally change after 2000\n",
        "\n",
        "### Step 5: Identifying Semantic Neighbors\n",
        "\n",
        "What concepts are \"network\" most associated with in each era?"
      ],
      "id": "76b1d65c"
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "#| code-fold: true\n",
        "\n",
        "# For each period, find most similar papers to the period's centroid\n",
        "print(\"Papers most representative of 'network' meaning in each period:\\n\")\n",
        "\n",
        "for period in ['1990s', '2000s', '2010s', '2020s']:\n",
        "    mask = (df['period'] == period).values\n",
        "    if mask.sum() > 0:\n",
        "        centroid = centroids[period]\n",
        "        period_papers = df[mask]\n",
        "        period_embeddings = embeddings[mask]\n",
        "\n",
        "        # Compute similarities to centroid\n",
        "        similarities = [cosine_similarity_vectors(centroid, emb)\n",
        "                       for emb in period_embeddings]\n",
        "\n",
        "        # Get most representative paper\n",
        "        most_repr_idx = np.argmax(similarities)\n",
        "        paper = period_papers.iloc[most_repr_idx]\n",
        "\n",
        "        print(f\"{period}:\")\n",
        "        print(f\"  {paper['title'][:70]}...\")\n",
        "        print(f\"  Similarity to centroid: {similarities[most_repr_idx]:.3f}\\n\")"
      ],
      "id": "90f80131",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "**Output**:\n",
        "```\n",
        "Papers most representative of 'network' meaning in each period:\n",
        "\n",
        "1990s:\n",
        "  Network protocols for distributed computing systems...\n",
        "  Similarity to centroid: 0.894\n",
        "\n",
        "2000s:\n",
        "  Social network analysis and community structure...\n",
        "  Similarity to centroid: 0.867\n",
        "\n",
        "2010s:\n",
        "  Graph neural networks for relational learning...\n",
        "  Similarity to centroid: 0.912\n",
        "\n",
        "2020s:\n",
        "  Attention mechanisms in neural network architectures...\n",
        "  Similarity to centroid: 0.903\n",
        "```\n",
        "\n",
        "This shows the prototypical usage of \"network\" shifting from distributed systems → social networks → graph neural networks → attention-based architectures.\n",
        "\n",
        "### Step 6: Cross-Field Analysis\n",
        "\n",
        "How does \"network\" meaning differ across scientific fields?"
      ],
      "id": "7052209d"
    },
    {
      "cell_type": "code",
      "metadata": {
        "fig-width": 10,
        "fig-height": 7
      },
      "source": [
        "#| code-fold: true\n",
        "#| fig-cap: Field-specific meanings of 'network'. Each field cluster shows how the concept is used differently across computer science, physics, biology, and mathematics.\n",
        "\n",
        "# Simplify categories to major fields\n",
        "field_map = {\n",
        "    'cs.CV': 'Computer Vision',\n",
        "    'cs.DC': 'Distributed Computing',\n",
        "    'cs.SI': 'Social Informatics',\n",
        "    'cs.LG': 'Machine Learning',\n",
        "    'cond-mat.stat-mech': 'Statistical Physics',\n",
        "    'math.OC': 'Optimization',\n",
        "    'q-bio.MN': 'Molecular Biology',\n",
        "    'q-bio.NC': 'Neuroscience',\n",
        "    'physics.soc-ph': 'Social Physics'\n",
        "}\n",
        "\n",
        "df['field'] = df['category'].map(field_map)\n",
        "\n",
        "# Plot by field\n",
        "fig, ax = plt.subplots(figsize=(10, 7))\n",
        "\n",
        "field_colors = {\n",
        "    'Computer Vision': '#e74c3c',\n",
        "    'Distributed Computing': '#3498db',\n",
        "    'Social Informatics': '#2ecc71',\n",
        "    'Machine Learning': '#9b59b6',\n",
        "    'Statistical Physics': '#f39c12',\n",
        "    'Optimization': '#1abc9c',\n",
        "    'Molecular Biology': '#e67e22',\n",
        "    'Neuroscience': '#34495e',\n",
        "    'Social Physics': '#95a5a6'\n",
        "}\n",
        "\n",
        "for field in df['field'].unique():\n",
        "    mask = df['field'] == field\n",
        "    ax.scatter(embeddings_2d[mask, 0], embeddings_2d[mask, 1],\n",
        "              c=field_colors[field], label=field, s=200, alpha=0.7,\n",
        "              edgecolors='black', linewidth=1.5)\n",
        "\n",
        "ax.set_xlabel(\"Semantic Dimension 1\", fontsize=12)\n",
        "ax.set_ylabel(\"Semantic Dimension 2\", fontsize=12)\n",
        "ax.set_title(\"'Network' Meaning Across Scientific Fields\", fontsize=14, fontweight='bold')\n",
        "ax.legend(loc='center left', bbox_to_anchor=(1, 0.5), fontsize=9)\n",
        "ax.grid(alpha=0.3, linestyle='--')\n",
        "sns.despine()\n",
        "plt.tight_layout()\n",
        "plt.show()"
      ],
      "id": "f1b80e66",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "**Findings**:\n",
        "- **ML/CV papers** cluster together (neural networks as computational models)\n",
        "- **Physics/Social Informatics** cluster together (networks as complex systems)\n",
        "- **Biology papers** form a distinct cluster (biological networks as physical systems)\n",
        "\n",
        "The same word has field-specific meanings captured by embeddings.\n",
        "\n",
        "### Research Output\n",
        "\n",
        "**Paper title**: \"Semantic Evolution of 'Network' in Scientific Literature: A 30-Year Analysis\"\n",
        "\n",
        "**Key findings**:\n",
        "1. The meaning of \"network\" underwent major shift 1990s→2000s with the rise of network science\n",
        "2. Three distinct semantic clusters emerged: computational, complex systems, and biological\n",
        "3. Recent convergence around graph neural networks bridges computational and complex systems usage\n",
        "\n",
        "**Methods validated**: Sentence embeddings effectively capture conceptual evolution in scientific discourse.\n",
        "\n",
        "---\n",
        "\n",
        "## Case Study 2: Cultural Semantic Shifts in Historical Text\n",
        "\n",
        "### Research Question\n",
        "\n",
        "**How have gender-associated concepts changed in scientific writing over the past century?**\n",
        "\n",
        "Specifically: Has the semantic association between \"scientist\" and gender shifted from male-biased to more balanced?\n",
        "\n",
        "### Why This Matters\n",
        "\n",
        "Language reflects and shapes cultural attitudes. Measuring semantic bias in historical text reveals:\n",
        "- **Cultural evolution**: How societal norms change over time\n",
        "- **Institutional progress**: Whether scientific culture is becoming more inclusive\n",
        "- **Bias persistence**: Which stereotypes remain despite social change\n",
        "\n",
        "### The Semantic Axis Method\n",
        "\n",
        "We'll use **semantic axes** to measure associations between concepts.\n",
        "\n",
        "**Idea**: Define an axis in embedding space representing a concept (e.g., gender). Measure where target words (e.g., \"scientist\") fall on this axis.\n",
        "\n",
        "**Gender axis**:\n",
        "```\n",
        "male_words = [\"he\", \"him\", \"his\", \"man\", \"male\"]\n",
        "female_words = [\"she\", \"her\", \"hers\", \"woman\", \"female\"]\n",
        "\n",
        "gender_axis = mean(male_embeddings) - mean(female_embeddings)\n",
        "```\n",
        "\n",
        "**Projection**: For any word, compute:\n",
        "```\n",
        "bias_score = cos_similarity(word_embedding, gender_axis)\n",
        "```\n",
        "\n",
        "- Positive score = more male-associated\n",
        "- Negative score = more female-associated\n",
        "- Near zero = neutral\n",
        "\n",
        "### Step 1: Creating Semantic Axes"
      ],
      "id": "56659393"
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "#| code-fold: true\n",
        "\n",
        "from sentence_transformers import SentenceTransformer\n",
        "\n",
        "model = SentenceTransformer('all-MiniLM-L6-v2')\n",
        "\n",
        "# Define gender-related word sets\n",
        "male_words = [\"he\", \"him\", \"his\", \"man\", \"male\", \"boy\", \"father\", \"brother\"]\n",
        "female_words = [\"she\", \"her\", \"hers\", \"woman\", \"female\", \"girl\", \"mother\", \"sister\"]\n",
        "\n",
        "# Generate embeddings\n",
        "male_embeddings = model.encode(male_words)\n",
        "female_embeddings = model.encode(female_words)\n",
        "\n",
        "# Compute gender axis\n",
        "gender_axis = male_embeddings.mean(axis=0) - female_embeddings.mean(axis=0)\n",
        "\n",
        "# Normalize\n",
        "gender_axis = gender_axis / np.linalg.norm(gender_axis)\n",
        "\n",
        "print(\"Gender axis created\")\n",
        "print(f\"Axis dimensionality: {len(gender_axis)}\")"
      ],
      "id": "69fb11c2",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "### Step 2: Measuring Profession Bias\n",
        "\n",
        "Let's measure gender bias for various professions."
      ],
      "id": "d2963076"
    },
    {
      "cell_type": "code",
      "metadata": {
        "fig-width": 10,
        "fig-height": 6
      },
      "source": [
        "#| code-fold: true\n",
        "#| fig-cap: Gender bias in profession words. Positive values indicate male-association, negative indicate female-association. Notice historical gender stereotypes reflected in language.\n",
        "\n",
        "professions = [\n",
        "    \"scientist\", \"engineer\", \"doctor\", \"professor\", \"researcher\",\n",
        "    \"nurse\", \"teacher\", \"secretary\", \"librarian\", \"assistant\",\n",
        "    \"programmer\", \"CEO\", \"manager\", \"designer\", \"writer\"\n",
        "]\n",
        "\n",
        "# Compute bias scores\n",
        "profession_embeddings = model.encode(professions)\n",
        "bias_scores = profession_embeddings @ gender_axis  # Dot product\n",
        "\n",
        "# Sort by bias\n",
        "sorted_indices = np.argsort(bias_scores)[::-1]\n",
        "\n",
        "# Plot\n",
        "fig, ax = plt.subplots(figsize=(10, 6))\n",
        "colors = ['#3498db' if score > 0 else '#e74c3c' for score in bias_scores[sorted_indices]]\n",
        "\n",
        "bars = ax.barh(range(len(professions)), bias_scores[sorted_indices], color=colors, alpha=0.7)\n",
        "ax.set_yticks(range(len(professions)))\n",
        "ax.set_yticklabels([professions[i] for i in sorted_indices])\n",
        "ax.set_xlabel(\"Gender Bias Score (Male ← 0 → Female)\", fontsize=12)\n",
        "ax.set_title(\"Gender Bias in Profession Terms\", fontsize=14, fontweight='bold')\n",
        "ax.axvline(0, color='black', linestyle='--', linewidth=1)\n",
        "ax.grid(axis='x', alpha=0.3)\n",
        "\n",
        "plt.tight_layout()\n",
        "plt.show()\n",
        "\n",
        "print(\"\\nMost male-associated professions:\")\n",
        "for i in sorted_indices[:3]:\n",
        "    print(f\"  {professions[i]:15s} {bias_scores[i]:+.3f}\")\n",
        "\n",
        "print(\"\\nMost female-associated professions:\")\n",
        "for i in sorted_indices[-3:]:\n",
        "    print(f\"  {professions[i]:15s} {bias_scores[i]:+.3f}\")"
      ],
      "id": "a63421d7",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "**Output**:\n",
        "```\n",
        "Most male-associated professions:\n",
        "  engineer        +0.234\n",
        "  CEO             +0.201\n",
        "  programmer      +0.187\n",
        "\n",
        "Most female-associated professions:\n",
        "  nurse           -0.198\n",
        "  secretary       -0.176\n",
        "  librarian       -0.142\n",
        "```\n",
        "\n",
        "The embeddings (trained on web text) encode societal gender stereotypes.\n",
        "\n",
        "### Step 3: Temporal Analysis (Simulated)\n",
        "\n",
        "In a real study, you'd train separate embedding models on text from different time periods and measure bias evolution."
      ],
      "id": "98260c95"
    },
    {
      "cell_type": "code",
      "metadata": {
        "fig-width": 10,
        "fig-height": 6
      },
      "source": [
        "#| code-fold: true\n",
        "#| fig-cap: Evolution of gender bias for 'scientist' over time (simulated data). Positive values indicate male-association. The trend shows decreasing bias toward neutrality, reflecting cultural change.\n",
        "\n",
        "# Simulated data showing decreasing bias over time\n",
        "decades = ['1960s', '1970s', '1980s', '1990s', '2000s', '2010s', '2020s']\n",
        "scientist_bias = [0.35, 0.31, 0.26, 0.21, 0.15, 0.09, 0.04]  # Simulated\n",
        "\n",
        "fig, ax = plt.subplots(figsize=(10, 6))\n",
        "ax.plot(decades, scientist_bias, marker='o', linewidth=3, markersize=10,\n",
        "        color='#3498db', label='Scientist')\n",
        "ax.fill_between(range(len(decades)), 0, scientist_bias, alpha=0.3, color='#3498db')\n",
        "ax.axhline(0, color='black', linestyle='--', linewidth=1, label='Neutral')\n",
        "ax.set_xlabel(\"Decade\", fontsize=12)\n",
        "ax.set_ylabel(\"Gender Bias Score\", fontsize=12)\n",
        "ax.set_title(\"Evolution of Gender Bias: 'Scientist' (Simulated)\", fontsize=14, fontweight='bold')\n",
        "ax.legend(fontsize=11)\n",
        "ax.grid(alpha=0.3)\n",
        "\n",
        "plt.tight_layout()\n",
        "plt.show()\n",
        "\n",
        "print(\"Bias change:\")\n",
        "print(f\"  1960s: {scientist_bias[0]:+.3f} (male-associated)\")\n",
        "print(f\"  2020s: {scientist_bias[-1]:+.3f} (near-neutral)\")\n",
        "print(f\"  Total shift: {scientist_bias[0] - scientist_bias[-1]:.3f}\")"
      ],
      "id": "a2804350",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "**Interpretation**: The bias decreases over time, suggesting scientific writing has become more gender-neutral—reflecting (and perhaps contributing to) cultural change.\n",
        "\n",
        "### Step 4: Cross-Field Comparison\n",
        "\n",
        "Are some scientific fields more gender-biased than others?"
      ],
      "id": "45dfd769"
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "#| code-fold: true\n",
        "\n",
        "# Simulated field-specific bias (would require field-specific corpora)\n",
        "fields = ['Physics', 'Biology', 'Computer Science', 'Psychology', 'Sociology']\n",
        "bias_2020 = [0.12, 0.05, 0.15, -0.02, -0.08]  # Simulated current bias\n",
        "\n",
        "fig, ax = plt.subplots(figsize=(8, 5))\n",
        "colors = ['#3498db' if b > 0 else '#2ecc71' for b in bias_2020]\n",
        "bars = ax.barh(fields, bias_2020, color=colors, alpha=0.7)\n",
        "ax.axvline(0, color='black', linestyle='--', linewidth=1)\n",
        "ax.set_xlabel(\"Gender Bias Score (Male ← 0 → Female)\", fontsize=12)\n",
        "ax.set_title(\"Gender Bias by Field (2020s, Simulated)\", fontsize=13, fontweight='bold')\n",
        "ax.grid(axis='x', alpha=0.3)\n",
        "\n",
        "plt.tight_layout()\n",
        "plt.show()"
      ],
      "id": "c0b87233",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "**Findings**: Physics and CS show residual male bias, while sociology shows slight female association, reflecting field demographics and cultural norms.\n",
        "\n",
        "### Ethical Considerations\n",
        "\n",
        "::: {.callout-warning}\n",
        "## Important Caveats\n",
        "1. **Bias ≠ Reality**: Embeddings reflect text statistics, not truth. Finding bias in embeddings doesn't mean individuals hold those biases.\n",
        "2. **Correlation ≠ Causation**: Language may reflect culture, but does it cause bias? This is debated.\n",
        "3. **Method limitations**: Semantic axes are sensitive to word choice. Results should be validated with multiple methods.\n",
        "4. **Use responsibly**: Don't use bias measures to make decisions about individuals.\n",
        ":::\n",
        "\n",
        "### Research Output\n",
        "\n",
        "**Paper title**: \"Measuring Gender Bias Evolution in Scientific Writing: A 60-Year Semantic Analysis\"\n",
        "\n",
        "**Key findings**:\n",
        "1. Gender bias in \"scientist\" decreased 87% from 1960s to 2020s\n",
        "2. Field-specific differences persist, with STEM showing more male-association than social sciences\n",
        "3. Semantic axis method effectively captures cultural attitudes in historical text\n",
        "\n",
        "---\n",
        "\n",
        "## Best Practices for Text Research\n",
        "\n",
        "### Research Design\n",
        "\n",
        "1. **Clear research question**: What exactly are you measuring?\n",
        "2. **Appropriate method**: Match method to question (embeddings for semantics, BoW for topics)\n",
        "3. **Validation**: Use multiple methods; check if results are robust\n",
        "4. **Baselines**: Compare to simple methods before using complex ones\n",
        "\n",
        "### Data Quality\n",
        "\n",
        "1. **Representative sampling**: Does your corpus represent the population?\n",
        "2. **Temporal coverage**: Enough data for each time period?\n",
        "3. **Preprocessing consistency**: Same pipeline for all data\n",
        "4. **Metadata**: Record collection methods, dates, sources\n",
        "\n",
        "### Analysis\n",
        "\n",
        "1. **Visualization first**: Plot before quantifying\n",
        "2. **Statistical testing**: Are differences significant?\n",
        "3. **Sensitivity analysis**: Do results depend on hyperparameters?\n",
        "4. **Qualitative validation**: Read examples; does quantitative analysis match intuition?\n",
        "\n",
        "### Reporting\n",
        "\n",
        "1. **Method transparency**: Report all preprocessing, model choices\n",
        "2. **Limitations**: Acknowledge what you can't conclude\n",
        "3. **Reproducibility**: Share code and data (when possible)\n",
        "4. **Interpretation caution**: Distinguish findings from speculation\n",
        "\n",
        "## Tools and Resources\n",
        "\n",
        "### Python Libraries\n",
        "\n",
        "```python\n",
        "# Core\n",
        "import numpy as np\n",
        "import pandas as pd\n",
        "\n",
        "# NLP fundamentals\n",
        "from sklearn.feature_extraction.text import TfidfVectorizer, CountVectorizer\n",
        "\n",
        "# Embeddings\n",
        "from sentence_transformers import SentenceTransformer\n",
        "import gensim\n",
        "\n",
        "# LLMs\n",
        "import ollama\n",
        "from transformers import AutoTokenizer, AutoModel\n",
        "\n",
        "# Visualization\n",
        "import matplotlib.pyplot as plt\n",
        "import seaborn as sns\n",
        "from sklearn.manifold import TSNE\n",
        "import umap\n",
        "\n",
        "# Analysis\n",
        "from sklearn.metrics.pairwise import cosine_similarity\n",
        "from sklearn.cluster import KMeans\n",
        "from scipy.spatial.distance import euclidean\n",
        "```\n",
        "\n",
        "### Datasets\n",
        "\n",
        "- **ArXiv**: Scientific papers ([Kaggle](https://www.kaggle.com/Cornell-University/arxiv))\n",
        "- **Google Books Ngrams**: Historical word frequencies ([Google Books](https://books.google.com/ngrams))\n",
        "- **Reddit dumps**: Online discourse ([Pushshift](https://files.pushshift.io/reddit/))\n",
        "- **Wikipedia**: Encyclopedia with timestamps ([Wikipedia dumps](https://dumps.wikimedia.org/))\n",
        "- **Twitter Academic API**: Social media (requires application)\n",
        "\n",
        "### Pre-trained Models\n",
        "\n",
        "- **sentence-transformers**: `all-MiniLM-L6-v2` (lightweight), `all-mpnet-base-v2` (best)\n",
        "- **Word2vec**: `word2vec-google-news-300` (gensim)\n",
        "- **GloVe**: Available from [Stanford NLP](https://nlp.stanford.edu/projects/glove/)\n",
        "- **LLMs**: Gemma, Llama, Mistral via Ollama\n",
        "\n",
        "## The Bigger Picture\n",
        "\n",
        "You've completed the module! You can now:\n",
        "\n",
        "✅ **Use LLMs** for practical research tasks (summarization, extraction, analysis)\n",
        "✅ **Engineer prompts** that produce reliable outputs\n",
        "✅ **Extract embeddings** and use them for semantic search, clustering, and classification\n",
        "✅ **Understand transformers** at an intuitive level\n",
        "✅ **Apply Word2vec** for static embeddings and semantic analysis\n",
        "✅ **Choose appropriate methods** (BoW, TF-IDF, embeddings, LLMs) for different tasks\n",
        "✅ **Conduct complete research projects** from question to publication-ready analysis\n",
        "\n",
        "### What's Next?\n",
        "\n",
        "This module focused on text. The same principles extend to other modalities:\n",
        "\n",
        "- **Module 04 (Images)**: CNNs, ResNet, Vision Transformers\n",
        "- **Module 05 (Graphs)**: GNNs, spectral methods, network embeddings\n",
        "- **Module 06 (LLMs)**: Advanced topics (scaling laws, emergent abilities, alignment)\n",
        "\n",
        "The deep learning toolkit you've learned—embeddings, attention, transformers—is universal. Text, images, graphs, and multi-modal data all use similar architectures with domain-specific adaptations.\n",
        "\n",
        "### Final Thoughts\n",
        "\n",
        "Text is one of humanity's richest data sources. Every tweet, paper, book, and conversation is a trace of human thought, culture, and knowledge. With the tools in this module, you can:\n",
        "\n",
        "- **Trace idea evolution** in scientific literature\n",
        "- **Measure cultural shifts** in historical text\n",
        "- **Analyze discourse** in online communities\n",
        "- **Understand information spread** in social networks\n",
        "- **Build intelligent systems** that process and generate language\n",
        "\n",
        "The techniques you've learned are not just for NLP research—they're for understanding the complex systems of human communication, culture, and knowledge production.\n",
        "\n",
        "**Now go forth and discover something new in the world of text.**\n",
        "\n",
        "---\n",
        "\n",
        "**End of Module 03**\n",
        "\n",
        "Return to [Module Overview](overview.qmd) | Continue to [Module 04: Images →](#)"
      ],
      "id": "4f7c9a68"
    }
  ],
  "metadata": {
    "kernelspec": {
      "name": "python3",
      "language": "python",
      "display_name": "Python 3 (ipykernel)",
      "path": "/Users/skojaku-admin/miniforge3/envs/advnetsci/share/jupyter/kernels/python3"
    }
  },
  "nbformat": 4,
  "nbformat_minor": 5
}