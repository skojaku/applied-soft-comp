Traceback (most recent call last):
  File "/Users/skojaku-admin/miniforge3/envs/advnetsci/lib/python3.11/site-packages/jupyter_cache/executors/utils.py", line 58, in single_nb_execution
    executenb(
  File "/Users/skojaku-admin/miniforge3/envs/advnetsci/lib/python3.11/site-packages/nbclient/client.py", line 1305, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/skojaku-admin/miniforge3/envs/advnetsci/lib/python3.11/site-packages/jupyter_core/utils/__init__.py", line 165, in wrapped
    return loop.run_until_complete(inner)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/skojaku-admin/miniforge3/envs/advnetsci/lib/python3.11/asyncio/base_events.py", line 650, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/skojaku-admin/miniforge3/envs/advnetsci/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/skojaku-admin/miniforge3/envs/advnetsci/lib/python3.11/site-packages/nbclient/client.py", line 650, in async_setup_kernel
    yield
  File "/Users/skojaku-admin/miniforge3/envs/advnetsci/lib/python3.11/site-packages/nbclient/client.py", line 705, in async_execute
    await self.async_execute_cell(
  File "/Users/skojaku-admin/miniforge3/envs/advnetsci/lib/python3.11/site-packages/nbclient/client.py", line 1058, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/Users/skojaku-admin/miniforge3/envs/advnetsci/lib/python3.11/site-packages/nbclient/client.py", line 914, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
import torch
import torchvision
import torchvision.transforms as T
from PIL import Image
import requests
from io import BytesIO

# 1. Load the pre-trained GoogLeNet model
googlenet = torchvision.models.googlenet(pretrained=True)
googlenet.eval()  # set the model to inference mode

# 2. Load an example image from the web (replace with any image URL you want)
url = "https://raw.githubusercontent.com/pytorch/hub/master/imagenet_samples/imagenet_class_index.json"
response = requests.get("https://images.unsplash.com/photo-1595433562696-1e052b4d841d?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=60")
img = Image.open(BytesIO(response.content))

# 3. Define transformations: resize, center crop, convert to tensor, normalize
transform = T.Compose([
    T.Resize(256),
    T.CenterCrop(224),
    T.ToTensor(),
    T.Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
])

input_tensor = transform(img).unsqueeze(0)  # add batch dimension

# 4. Run a forward pass
with torch.no_grad():
    output = googlenet(input_tensor)

# 5. Load ImageNet labels for interpreting the output
# In a standard environment, you can download labels like below or store them locally
labels_url = "https://raw.githubusercontent.com/pytorch/hub/master/imagenet_classes.txt"
labels_response = requests.get(labels_url)
categories = labels_response.text.strip().split("\n")

# 6. Get the predicted class
_, predicted_idx = torch.max(output, 1)
predicted_category = categories[predicted_idx]
print("Predicted category:", predicted_category)
------------------

----- stderr -----
/Users/skojaku-admin/miniforge3/envs/advnetsci/lib/python3.11/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/Users/skojaku-admin/miniforge3/envs/advnetsci/lib/python3.11/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=GoogLeNet_Weights.IMAGENET1K_V1`. You can also use `weights=GoogLeNet_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
------------------

[0;31m---------------------------------------------------------------------------[0m
[0;31mUnidentifiedImageError[0m                    Traceback (most recent call last)
Cell [0;32mIn[3], line 15[0m
[1;32m     13[0m url [38;5;241m=[39m [38;5;124m"[39m[38;5;124mhttps://raw.githubusercontent.com/pytorch/hub/master/imagenet_samples/imagenet_class_index.json[39m[38;5;124m"[39m
[1;32m     14[0m response [38;5;241m=[39m requests[38;5;241m.[39mget([38;5;124m"[39m[38;5;124mhttps://images.unsplash.com/photo-1595433562696-1e052b4d841d?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=60[39m[38;5;124m"[39m)
[0;32m---> 15[0m img [38;5;241m=[39m Image[38;5;241m.[39mopen(BytesIO(response[38;5;241m.[39mcontent))
[1;32m     17[0m [38;5;66;03m# 3. Define transformations: resize, center crop, convert to tensor, normalize[39;00m
[1;32m     18[0m transform [38;5;241m=[39m T[38;5;241m.[39mCompose([
[1;32m     19[0m     T[38;5;241m.[39mResize([38;5;241m256[39m),
[1;32m     20[0m     T[38;5;241m.[39mCenterCrop([38;5;241m224[39m),
[1;32m     21[0m     T[38;5;241m.[39mToTensor(),
[1;32m     22[0m     T[38;5;241m.[39mNormalize(mean[38;5;241m=[39m[[38;5;241m0.485[39m, [38;5;241m0.456[39m, [38;5;241m0.406[39m], std[38;5;241m=[39m[[38;5;241m0.229[39m, [38;5;241m0.224[39m, [38;5;241m0.225[39m])
[1;32m     23[0m ])

File [0;32m~/miniforge3/envs/advnetsci/lib/python3.11/site-packages/PIL/Image.py:3536[0m, in [0;36mopen[0;34m(fp, mode, formats)[0m
[1;32m   3534[0m     warnings[38;5;241m.[39mwarn(message)
[1;32m   3535[0m msg [38;5;241m=[39m [38;5;124m"[39m[38;5;124mcannot identify image file [39m[38;5;132;01m%r[39;00m[38;5;124m"[39m [38;5;241m%[39m (filename [38;5;28;01mif[39;00m filename [38;5;28;01melse[39;00m fp)
[0;32m-> 3536[0m [38;5;28;01mraise[39;00m UnidentifiedImageError(msg)

[0;31mUnidentifiedImageError[0m: cannot identify image file <_io.BytesIO object at 0x1449ae980>

